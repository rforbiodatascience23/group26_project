# Libraries 
```{r}
library(tidyverse)
library(base)
library(patchwork)
library(scales)
library(ggridges)
library(patchwork)
library(ggseqlogo)
library(dplyr)
library(table1)
```


```{r}
rhc_clean |> select(age, sex, edu, race, income)
```
```{r}
# Histogram of Age
rhc_clean |>
  ggplot(aes(x = age)) +
  geom_histogram(binwidth = 5,
                 fill = "skyblue", color = "black") +
  labs(title = "Distribution of Age",
       x = "Age",
       y = "Frequency") +
  theme_minimal()

```

```{r}
# rhc_clean |>
#   ggplot(aes(x = sex, 
#              fill=factor(death))) +
#   geom_bar() +
#   labs(title = "Death females vs. males",
#        x = "Gender",
#        y = "Number of patients") +
#   #scale_fill_manual(name= "Death", values = c("0" = "blue", "1" = "red")) +
#   theme_minimal()



rhc_clean |>
  ggplot(aes(x = age, 
             fill=factor(death))) +
  geom_bar() +
  labs(title = "Death in different ages",
       x = "Age",
       y = "Number of patients") +
  #scale_fill_manual(name= "Death", values = c("0" = "blue", "1" = "red")) +
  theme_minimal()

```
```{r}
colnames(rhc_data)
```

```{r}
```


```{r}
rhc_data |> 
  ggplot(aes(x = income, 
           fill = as.factor(swang1))) +
  geom_bar() +
  labs(title = "Distribution of Income by RHC Status",
       x = "Income",
       y = "Count",
       fill = "RHC Status")
```


```{r}
rhc_data |> 
  ggplot(aes(x = as.factor(sex), 
             y = age, 
             fill = as.factor(swang1))) +
  geom_bar(stat = "summary", fun = "mean", position = "dodge") +
  labs(title = "Average Age by Sex and RHC",
       x = "Sex",
       y = "Average Age",
       fill = "RHC Status")


```
```{r}
# Create a bar plot for the count of RHC by Sex
rhc_data |> 
  ggplot(aes(x = as.factor(edu), 
             fill = as.factor(swang1))) +
  geom_bar() +
  labs(title = "Distribution of Education by RHC Status",
       x = "Education",
       y = "Count",
       fill = "RHC Status") 

```


```{r}
rhc_data |> 
  ggplot(aes(x = race, 
             fill = as.factor(swang1))) +
  geom_bar() +
  labs(title = "Distribution of Race by RHC Status",
       x = "Race",
       y = "Count",
       fill = "RHC Status")
```


