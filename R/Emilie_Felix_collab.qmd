---
title: "Emilie_Felix_collab"
format: html
editor: visual
---

## 

The surv2md1is an estimate of the probability of surviving the first two months after admission to the hospital. The Aps1 is the APACHE score, which is a score given to patients in the ICU based on their vital scores, age and overall health, this score estimates the mortality of the patient based on how ill they are usually this ranges from 0-71, but in this data set the min and max are 3-147.

We wish to model what scores indicates death and what scores indicate you will survive for the two different scores.

```{r}
library(tidyverse)
library(base)
library(patchwork)
library(scales)
library(ggridges)
library(patchwork)
library(ggseqlogo)
library(dplyr)
library(table1)
```

```{r}
rhc_clean |> 
  select(ptID, aps1, death) |> 
  ggplot(aes(x = aps1, fill=factor(death))) +
  geom_bar(position = "stack") 
  
  
```

```{r}
rhc_clean |> 
  select(ptID, aps1, death) |> 
   mutate(aps1_Interval = cut(aps1, breaks = c(0,10,20,30,40,50,60,70,80,90,100,110,120,130,140,150), labels = c("0-10", "10-20", "20-30", "30-40", "40-50","50-60", "60-70", "70-80", "80-90", "90-100","100-110", "110-120", "120-130", "130-140", "140-150"))) |> 
  
ggplot(aes(x = aps1_Interval, fill=factor(death))) +
  geom_bar(position = "stack") 
  
  
```

It looks like there might be a correlation between a higher aps1 score and dying.we will now try and model this.

```{r}

aps1_data <- rhc_clean |> 
  select(ptID, aps1, death) |> 
   mutate(aps1_Interval = cut(aps1, breaks = c(0,10,20,30,40,50,60,70,80,90,100,110,120,130,140,150), labels = c("0-10", "10-20", "20-30", "30-40", "40-50","50-60", "60-70", "70-80", "80-90", "90-100","100-110", "110-120", "120-130", "130-140", "140-150")))


my_first_model <- lm(
                      formula = aps1 ~ death,
                      data = aps1_data)

my_first_model

   
```

```{r}
aps1_data |> 
  group_by(death) |> 
  summarise(mu=mean(aps1))

```

The intercept is the mean aps1 for those that are not dead and the slope is the difference between the mean values.

It is positive which indicates a higher aps1 increases the risk of death.

```{r}
my_first_model |> 
  summary()
```
