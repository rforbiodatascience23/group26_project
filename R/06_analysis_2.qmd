## Here we will do a DISEASE analysis

## copypaste your code snippets that fit for this analysis. Dont delete your original document until we are completely finished, but rename it as _done. Fks. mine is Josefine_DONE.qmd. This way we have a backup if something fucks up. 

##only write under your own name :)) 



#Emilie
Plots

```{r}
library(tidyverse)
library(base)
library(patchwork)
library(scales)
library(ggridges)
library(patchwork)
library(ggseqlogo)
library(dplyr)
library(table1)
```

Does the number of comorbidity diseases influence the risk of death?

```{r}
rhc_aug |>
  ggplot(aes(x = comorbidities, fill=factor(death))) +
  geom_bar(position = "stack") +
  labs(title = "Risk of dying by number of comorbidities",
       x = "Number of comorbidities",
       y = "Number of patients") +
  scale_fill_manual(name= "Death", values = c("0" = "blue", "1" = "red")) +
  theme_minimal()
```

```{r}
rhc_aug |>
  ggplot(aes(x = comorbidities, fill=factor(death))) +
  facet_wrap(~swang1)+
  geom_bar(position = "stack") +
  labs(title = "Risk of dying by number of comorbidities",
       x = "Number of comorbidities",
       y = "Number of patients") +
  scale_fill_manual(name= "Survival", values = c("0" = "#619CFF", "1" = "#F8766D"), labels= c('Dead', 'Alive')) +
  theme_minimal()
```

```{r}
rhc_aug |> 
  ggplot(aes(x = aps1, fill=factor(death))) +
  geom_bar(position = "stack") 
  
```

```{r}
rhc_aug |> 
  ggplot(aes(x = aps1_Interval, fill=factor(death))) +
  geom_bar(position = "stack") 

```




#Sahand




#Judith




#Felix




#Josefine 
This can be used to plot all individual variables to compare the variable with how many people died
```{r}
rhc_clean |> count(death, swang1) |> 
  ggplot(aes(x = swang1, y = n, fill = death))+
  geom_col(alpha = 1,
           color="pink") +
  labs(x = 'swang',
       y = 'n') +
  theme(axis.text.x = element_text(angle = 20, hjust = 1))
```


  
This can be used to plot one individual disease and see how many peole has the disease 
```{r}
rhc_clean |> ggplot(aes(x = dementhx)) + geom_bar(alpha = 0.6, color = "black") + 
                  labs(x = 'dementhx', y = 'counts')

```

This is to see all the diseases and how many people have it =1 or dont = 0
```{r}
subHX <- rhc_clean |> select(ends_with("hx"))

subHX <- subHX |> pivot_longer(everything(),
                      names_to = "variables",
                      values_to = "values")

subHX |> mutate(values = factor(values)) |> 
  ggplot(aes(x = variables, fill = values)) +
  theme(axis.text.x = element_text(angle = 20, hjust = 1)) +
  geom_bar(position = "dodge")

```


Scatterplot of diseases vs getting RHC
```{r}
rhc_clean
rhc_clean |> pivot_longer(ends_with("hx"),
                      names_to = "variables",
                      values_to = "values") |> 
  ggplot(aes(x = variables, y = swang1, color = values)) +
  theme(axis.text.x = element_text(angle = 20, hjust = 1)) +
  geom_point()



```

