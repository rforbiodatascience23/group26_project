```{r}
library(ggplot2)
library(table1)
```

Table1
```{r}

T1 <- rhc_clean |> mutate(sex = factor(sex),
                    swang1 = factor(swang1),
                    death = factor(x = death, levels = c(0,1), c("Alive","Dead"))) |> 
  table1(x = formula(~ sex + age + race + swang1 | death),
         data = _) 
T1

```

This can be used to plot all individual variables to compare the variable with how many people died
```{r}
rhc_clean |> count(death, swang1) |> 
  ggplot(aes(x = swang1, y = n, fill = death))+
  geom_col(alpha = 1,
           color="pink") +
  labs(x = 'swang',
       y = 'n') +
  theme(axis.text.x = element_text(angle = 20, hjust = 1))
```


  
This can be used to plot one individual disease and see how many peole has the disease 
```{r}
rhc_clean |> ggplot(aes(x = dementhx)) + geom_bar(alpha = 0.6, color = "black") + 
                  labs(x = 'dementhx', y = 'counts')

```

This is to see all the diseases and how many people have it =1 or dont = 0
```{r}
subHX <- rhc_clean |> select(ends_with("hx"))

subHX <- subHX |> pivot_longer(everything(),
                      names_to = "variables",
                      values_to = "values")

subHX |> mutate(values = factor(values)) |> 
  ggplot(aes(x = variables, fill = values)) +
  theme(axis.text.x = element_text(angle = 20, hjust = 1)) +
  geom_bar(position = "dodge")

```


Scatterplot of diseases vs getting RHC
```{r}
rhc_clean
rhc_clean |> pivot_longer(ends_with("hx"),
                      names_to = "variables",
                      values_to = "values") |> 
  ggplot(aes(x = variables, y = swang1, color = values)) +
  theme(axis.text.x = element_text(angle = 20, hjust = 1)) +
  geom_point()



```


What diseases lead to getting RHC

What diseases lead to death even when getting RHC

What 